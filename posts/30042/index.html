<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-tilt-brush.png">
  <link rel="mask-icon" href="/images/favicon-32x32-tilt-brush.png" color="#222">
  <meta name="google-site-verification" content="ttIkhAIFZQM9Huj8roB0l95ePN2Tv2zv2wRFksi09WA">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Pacifico:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"imzlp.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false,"width":280},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"manual"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"code_unfold":{"enable":true,"CODE_MAX_HEIGHT":600},"path":"search.xml"};
  </script>

  <meta name="description" content="Oculus Quest是Oculus发布的新一代支持6DoF的VR一体机设备，不需要连接PC以及额外的定位基站，而且支持Guardian，当戴着头显走出定位边界时，头显中会立即显示现实中的画面，防止玩家误碰出现意外情况。Oculus Quest使用两个Pentile OLED的屏幕，单眼分辨率为1440x1600，刷新率为72Hz，使用的是arm架构的高通骁龙835处理器，与两年前的Androi">
<meta property="og:type" content="article">
<meta property="og:title" content="Oculus Quest Development with UE4">
<meta property="og:url" content="https://imzlp.com/posts/30042/index.html">
<meta property="og:site_name" content="循迹研究室">
<meta property="og:description" content="Oculus Quest是Oculus发布的新一代支持6DoF的VR一体机设备，不需要连接PC以及额外的定位基站，而且支持Guardian，当戴着头显走出定位边界时，头显中会立即显示现实中的画面，防止玩家误碰出现意外情况。Oculus Quest使用两个Pentile OLED的屏幕，单眼分辨率为1440x1600，刷新率为72Hz，使用的是arm架构的高通骁龙835处理器，与两年前的Androi">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/20190925000314.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/oculus-quest-enable-advance-setting.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/oculus-quest-enable-development-mode.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/oculus-quest-vr-view-unkonw-source.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/preinstall-nvidia-codeworks-for-android.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/install-nvidia-codeworks-for-android.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/system-environment-variable.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-create-quest-project.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue-editor-enable-oculus-vr-plugin.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-Engine-Input.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-engine-rending.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-android-sdk.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-android.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-setting-android-seted.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-setting-android-remove-oculus-signature-and-configuration-androidManifest.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-editor-launnch-quest.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-package-android-error-assdebug.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-android-extra-permissions.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-package-android-texture-format.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/scrpcy-quest-view.webp">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/scrpcy-quest-view-2.webp">
<meta property="article:published_time" content="2019-09-24T10:41:10.000Z">
<meta property="article:modified_time" content="2020-09-17T21:31:19.000Z">
<meta property="article:author" content="查利鹏">
<meta property="article:tag" content="UnrealEngine">
<meta property="article:tag" content="VR">
<meta property="article:tag" content="OculusQuest">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/30042/20190925000314.webp">

<link rel="canonical" href="https://imzlp.com/posts/30042/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Oculus Quest Development with UE4 | 循迹研究室</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FDCJ41EFP5"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-FDCJ41EFP5');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.7.0/style.min.css" /><!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="循迹研究室" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">循迹研究室</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        
            
  <li class="menu-item menu-item-notes">

    <a href="/notes/" rel="section"><i class="fa fa-edit fa-fw"></i>笔记</a>

  </li>


      
        
            
  <li class="menu-item menu-item-essay">

    <a href="/essay/" rel="section"><i class="fas fa-feather-alt fa-fw"></i>随笔</a>

  </li>


      
        
            
  <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-inbox fa-fw"></i>资源</a>

  </li>


      
        <li class="menu-item menu-item-friends">

    <a href="/friends/" rel="section"><i class="fas fa-link fa-fw"></i>友链</a>

  </li>
        
            
  <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>


      
        <li class="menu-item menu-item-showcase">

    <a href="/showcase/" rel="section"><i class="fa fa-solid fa-trophy fa-fw"></i>展示柜</a>

  </li>
        <li class="menu-item menu-item-changelog">

    <a href="/changelog/" rel="section"><i class="fa fa-history fa-fw"></i>站点日志</a>

  </li>
        <li class="menu-item menu-item-opensource">

    <a href="/opensource/" rel="section"><i class="fas fa-code-branch fa-fw"></i>开源项目</a>

  </li>
        <li class="menu-item menu-item-uewiki">

    <a href="https://ue5wiki.com/" rel="noopener" target="_blank"><i class="fab fa-wikipedia-w fa-fw"></i>虚幻知识库</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>站内搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>



<script type="text/javascript">
  let domain='aW16bHAuY29t';
  let domain_str = atob(domain);
  let pathname = location.pathname;
  if (domain_str!= location.host.toLowerCase()){
        console.log(`this host is not safe,jump to https://${domain_str}${pathname}`);
        location.href=`https://${domain_str}${pathname}`;
  }
</script>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"
  >
    <link itemprop="mainEntityOfPage" href="https://imzlp.com/posts/30042/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
      <meta itemprop="name" content="查利鹏">
      <meta itemprop="description" content="唯有热爱可抵岁月漫长。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="循迹研究室">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Oculus Quest Development with UE4<a href="https://github.com/imzlp/blog-md/blob/master/_posts/2019-09-24-30042.md" class="post-edit-link" title="编辑" style="float: right;border-bottom: 0px;" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a>
        </h1>

        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-24 10:41 10:41:10:41" itemprop="dateCreated datePublished" datetime="2019-09-24T10:41:10+00:00">2019-09-24 10:41</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-17 21:31 21:31:19:31" itemprop="dateModified" datetime="2020-09-17T21:31:19+00:00">2020-09-17 21:31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UnrealEngine/" itemprop="url" rel="index"><span itemprop="name">UnrealEngine</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UnrealEngine/VR/" itemprop="url" rel="index"><span itemprop="name">VR</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UnrealEngine/VR/Quest/" itemprop="url" rel="index"><span itemprop="name">Quest</span></a>
                </span>
            </span>

          
            <span id="/posts/30042/" class="post-meta-item leancloud_visitors" data-flag-title="Oculus Quest Development with UE4" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>17 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><a target="_blank" rel="noopener" href="https://www.oculus.com/quest/">Oculus Quest</a>是Oculus发布的新一代支持6DoF的VR一体机设备，不需要连接PC以及额外的定位基站，而且支持Guardian，当戴着头显走出定位边界时，头显中会立即显示现实中的画面，防止玩家误碰出现意外情况。<br><a target="_blank" rel="noopener" href="https://www.oculus.com/quest/">Oculus Quest</a>使用两个<code>Pentile OLED</code>的屏幕，单眼分辨率为<code>1440x1600</code>，刷新率为<code>72Hz</code>，使用的是<code>arm</code>架构的高通骁龙835处理器，与两年前的Android旗舰级的处理器相同(如小米6、三星S8)。<br>Quest使用的是<code>Oculus Insight</code>(inside-out tracing)定位方案，使用四枚摄像头进行位置追踪，分别位于头显面板的四角。<br>发布会时对Oculus Insight的介绍：<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=2jY3B_F3GZk">Oculus Insight VR Positional Tracking System (Sep 2018)</a></p>
<p>以及国外的一个老哥对Quest追踪范围的测试视频：<a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1-bqNmwUi8J57yykxLP6szgiLeU3IgdgL/view">Quest Distance Test</a>.</p>
<p><code>Oculus Quest</code>64G存储版本的售价为399刀，128G的为499刀，不计税的价格大概是3500；相比较HTC的同类新产品(HTC Vive Focus)是便宜了不少，与PC-Base VR相比那就更具优势了，还不需要一台高性能的主机，我觉得6DoF的VR一体机设备一定是未来的趋势！</p>
<blockquote>
<p>国庆前的OC6，Oculus发布了Oculus Link和finger tracking两项技术，十分厉害，十分看好。</p>
</blockquote>
<p>整套Quest设备的大小与<code>10.5</code>寸的iPad差不多，提个小包就能带走：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/20190925000314.webp"></p>
<p>Quest设备的参数细节不再多说，本篇文章的主要内容是使用UE来开发Quest项目时的环境部署、开发文档、调试工具以及额外的注意事项，会持续更新。</p>
<span id="more"></span>
<p>首先想要在Quest上打包测试应用需要先打开Quest的开发者模式。</p>
<p>首先用一根Type-C的数据线将Quest连接至电脑，在头显中会提示是否允许USB调试，勾选允许。<br>之后就可以在PC上用<a target="_blank" rel="noopener" href="https://developer.android.com/studio/command-line/adb">Adb</a>连接到Quest了，Quest上的系统也是基于Android的，可以使用<a target="_blank" rel="noopener" href="https://developer.android.com/studio/command-line/adb">Adb</a>进行调试。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br></pre></td></tr></table></figure>
<p>就可以连接到Quest设备了，可以查看<code>/system/build.props</code>查看设备信息。我导出了一份：<a target="_blank" rel="noopener" href="https://gist.github.com/hxhb/0c72c436044e97f3f11ea44ad7f92912">build.props</a>。</p>
<p>也可以直接使用adb来安装apk：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb install xxxx.apk</span><br></pre></td></tr></table></figure>

<p>另外可以使用<a target="_blank" rel="noopener" href="https://github.com/the-expanse/SideQuest">SideQuest</a>这个开源工具在PC上管理基于Android的VR设备，当然Quest也适用，可以安装或者卸载软件。</p>
<h3 id="Oculus-Developer-Mode"><a href="#Oculus-Developer-Mode" class="headerlink" title="Oculus Developer Mode"></a>Oculus Developer Mode</h3><p>在进行真正的开发环境设置之前，需要将Quest开启<strong>开发者模式</strong>，设置开发者模式的前提是需要在<a target="_blank" rel="noopener" href="https://dashboard.oculus.com/">Oculus Dashboard</a>上加入或者<a target="_blank" rel="noopener" href="https://dashboard.oculus.com/organizations/create/">创建</a>开发者组织。</p>
<p>然后使用具有开发者组织的Oculus账号登陆移动端的<code>Oculus</code>App：</p>
<ul>
<li>iOS版本的可以从App Store安装：<a target="_blank" rel="noopener" href="https://apps.apple.com/us/app/oculus/id1366478176">Oculus for iOS</a></li>
<li>Android可以从Google Play安装：<a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.oculus.twilight&hl=en_US">Oculus for Android</a>，国内没有GMS环境的可以从我下载的apk直接安装:<a target="_blank" rel="noopener" href="https://stusdnueducn-my.sharepoint.com/:u:/g/personal/2017020625_stu_sdnu_edu_cn/EY8fEpU2L1VBk2EbDnQJKywBIzPBmRMIzySCX85MXFZ_IA?e=rtDrIQ">下载地址</a>.</li>
</ul>
<p>安装之后，登录账号，找到与账号关联的Quest设备，选择<strong>更多设置</strong>：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/oculus-quest-enable-advance-setting.webp"><br>然后找到<strong>开发者模式</strong>，启用即可。<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/oculus-quest-enable-development-mode.webp"></p>
<p>启用之后就可以在Quest里的<code>Library</code>下看到<code>Unknow Source</code>，也就是未知来源应用了(后续测试安装的都在这个分类下)。<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/oculus-quest-vr-view-unkonw-source.webp"></p>
<h3 id="NVIDIA-CodeWorks-for-Android"><a href="#NVIDIA-CodeWorks-for-Android" class="headerlink" title="NVIDIA CodeWorks for Android"></a>NVIDIA CodeWorks for Android</h3><p>因为本质上Quest跑的就是Android系统，所以我们打包的游戏就是安卓上的apk，那么为了能顺利打包成功apk，则需要安装Android的开发环境。<br>我们需要安装<code>android-sdk</code>/<code>jdk</code>/<code>android-ndk</code>/<code>gradle</code>/<code>apache-ant</code>等一系列环境，不过一个好消息是，NVIDIA有一个<a target="_blank" rel="noopener" href="https://developer.nvidia.com/codeworks-android">NVIDIA CodeWorks for Android</a>能够极大简化安装Android开发环境的流程。</p>
<p>各个平台的<code>CodeWorks for Android</code>安装包可以从UE引擎的下列目录找到：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UE_4.23_Source\Engine\Extras\AndroidWorks\Win64</span><br></pre></td></tr></table></figure>
<p>也可以从NVIDIA的<a target="_blank" rel="noopener" href="https://developer.nvidia.com/gameworksdownload#?dn=codeworks-for-android-1r8">Download Center</a>下载。<br>启动安装，选择<code>安装目录</code>和<code>下载目录</code>：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/preinstall-nvidia-codeworks-for-android.webp"></p>
<p>安装完成之后打开安装路径(默认在<code>C:\NVPACK\</code>)，启动<code>Chooser.exe</code>：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/install-nvidia-codeworks-for-android.webp"></p>
<p>选择<code>Standard</code>之后点击右下角的<code>Next</code>即可开始下载并安装。<br>鉴于国内的网络环境实在太差，有些库确实下载不下来，我把<code>Standard</code>下所有的都下载下来了，下载地址：<a target="_blank" rel="noopener" href="https://stusdnueducn-my.sharepoint.com/:f:/g/personal/2017020625_stu_sdnu_edu_cn/ErTM0Ov4H6FOoCoPKb1IaLoBevJ1J_M3vRqwEFNSUtTGZQ?e=If69z7">CodeWorks_1R7</a>，下载之后将其放到安装<code>CodeWorks</code>时选择的下载目录中，然后重新启动<code>Chooser.exe</code>，点击<code>Next</code>它会自己验证并且安装。</p>
<blockquote>
<p>如果不想安装CodeWorks，则可以仅仅只下载Android环境：<a target="_blank" rel="noopener" href="https://stusdnueducn-my.sharepoint.com/:u:/g/personal/2017020625_stu_sdnu_edu_cn/EbE_rZl0OVpOrfyNOZ9DlGsBX0q-AcZHGvKhCz9JwBS5RA?e=pTGgQf">NVPACK_1R7u1_20190923</a>，然后把下面的环境变量添加进系统中。</p>
</blockquote>
<p>安装完成之后会在系统中自动添加下列环境变量：</p>
<table>
<thead>
<tr>
<th>Environment var NAME</th>
<th>Value</th>
</tr>
</thead>
<tbody><tr>
<td>ANDROID_HOME</td>
<td>C:\NVPACK\android-sdk-windows</td>
</tr>
<tr>
<td>ANDROID_NDK_ROOT</td>
<td>C:\NVPACK\android-ndk-r14b</td>
</tr>
<tr>
<td>ANT_HOME</td>
<td>C:\NVPACK\apache-ant-1.8.2</td>
</tr>
<tr>
<td>GRADLE_HOME</td>
<td>C:\NVPACK\gradle-4.1</td>
</tr>
<tr>
<td>JAVA_HOME</td>
<td>C:\NVPACK\jdk1.8.0_77</td>
</tr>
<tr>
<td>NDK_ROOT</td>
<td>C:\NVPACK\android-ndk-r14b</td>
</tr>
<tr>
<td>NDKROOT</td>
<td>C:\NVPACK\android-ndk-r14b</td>
</tr>
<tr>
<td>NVPACK_NDK_TOOL_VERSION</td>
<td>4.9</td>
</tr>
<tr>
<td>NVPACK_NDK_VERSION</td>
<td>android-ndk-r14b</td>
</tr>
<tr>
<td>NVPACK_ROOT</td>
<td>D:\NVPACK</td>
</tr>
</tbody></table>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/system-environment-variable.webp"><br>这些环境变量在UE项目的<code>Project Setting</code>-<code>Android SDK</code>中被用到。</p>
<blockquote>
<p>注意：最好确保环境变量的路径中没有特殊字符，纯数字+字母最好的。</p>
</blockquote>
<h3 id="Create-Quest-Project-with-UE4"><a href="#Create-Quest-Project-with-UE4" class="headerlink" title="Create Quest Project with UE4"></a>Create Quest Project with UE4</h3><p>首先启动Unreal Engine，我使用是从EpicLauncher安装的UE_4.21.2版本。<br>为了方便测试，我创建了一个VR Template项目，注意<code>Target</code>选为<code>Mobile</code>：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-create-quest-project.webp"></p>
<ol start="0">
<li><p>创建完成启动UE Editor之后，先检查<code>Oculus VR</code>插件有没有启用。<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue-editor-enable-oculus-vr-plugin.webp"></p>
</li>
<li><p>打开<code>Project Setting</code>-<code>Engin</code>-<code>Input</code>确认<code>Mobile</code>-<code>Default Touch Interface</code>是<code>none</code>：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-Engine-Input.webp"></p>
</li>
<li><p>打开<code>Project Setting</code>-<code>Engine</code>-<code>Rending</code>确认<code>Mobile HDR</code>是关闭的：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-engine-rending.webp"></p>
</li>
<li><p>打开<code>Project Setting</code>-<code>Platform</code>-<code>Android SDK</code><br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-android-sdk.webp"><br>这里主要是设置Android开发环境的路径，如SDK/NDK/JDK，可以看上图的提示，如果不指定就会从系统中查找指定NAME的环境变量，因为我们安装CodeWorks时它已经帮我们添加了，此处可以忽略，如果是自己安装的环境则需要在这里指定或者直接添加到系统的环境变量。</p>
</li>
<li><p>打开<code>Priject Setting</code>-<code>Platform</code>-<code>Android</code><br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-android.webp"><br>分别执行<code>Configure Now</code>和<code>Accept SDK License</code>。</p>
<blockquote>
<p>注意：如果不执行<code>Accept SDK License</code>会在Launch时遇到<code>License not accepted</code>错误。</p>
</blockquote>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">License not accepted. SDK License must be accepted <span class="keyword">in</span> the Android project settings to deploy your app to the device.  </span><br></pre></td></tr></table></figure>
<p>将<code>Minimum SDK Version</code>设置为<code>25</code>，<code>Target SDK Version</code> 设置为<code>26</code>。<br>以及启用<code>Enable FullScreen Immersive on KitKat and above device</code>。<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-setting-android-seted.webp"><br>之后向下滚动找到<code>Advanced APK Packing</code>，并启用下列两项：</p>
<ul>
<li><code>Configure the AndroidManifest for deployment to Oculus Mobile</code></li>
<li><code>Rmove Oculus Signature File From Distribution APK</code></li>
</ul>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-setting-android-remove-oculus-signature-and-configuration-androidManifest.webp"></p>
<ol start="5">
<li>打开<code>Priject Setting</code>-<code>Project</code>-<code>Supported Platforms</code>启用<code>Android</code>；</li>
<li>将该VR模板项目的<code>Editor Startup Map</code>以及<code>Game Default Map</code>改为<code>MotionControllerMap</code>；</li>
<li>使用Type-C的USB线将Quest连接至PC；</li>
<li>关闭Editor，重启项目；</li>
</ol>
<p>重启项目之后即可在编辑器工具栏的<code>Launch</code>下找到<code>Quest</code>：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-editor-launnch-quest.webp"><br>启动即可开始编译并在Quest中测试当前项目(会被自动安装到Quest中，在<code>Unknow Source</code>下)。</p>
<p>如果在Launch或者打包时遇到<code>:app:assembleDebug</code>错误，则将<code>Project Setting</code>-<code>Platform</code>-<code>Android</code>下的<code>Enable Grade instead of Ant</code>关闭即可；如果非要用<code>grade</code>则检查<code>JAVE_HOME</code>环境变量设置的路径中是否含有特殊字符，最好只有数字+字母。<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-package-android-error-assdebug.webp"></p>
<blockquote>
<p>如果想要使用Vulkan，则需要将UE升级到4.22.2+.</p>
</blockquote>
<h3 id="解决Quest只追踪一只手柄"><a href="#解决Quest只追踪一只手柄" class="headerlink" title="解决Quest只追踪一只手柄"></a>解决Quest只追踪一只手柄</h3><p>在第一次启动之后测试发现，在游戏中同一时刻只有一只手柄可以被控制，无法同时使用两只手柄。本来以为是bug，查了一些资料后发现，这是因为没有在打包时强制指定要求6DoF，详见文档：<a target="_blank" rel="noopener" href="https://developers.google.com/vr/develop/android/3dof-to-6dof">Enabling 6DoF head tracking</a>。<br>项目中默认的是没有指定<code>3DoF</code>还是<code>6DoF</code>，默认是<code>3DoF</code>的，所以只有一只手柄能够追踪。</p>
<p>解决的办法是在<code>Intermediate/Android/APK/AndroidManifest.xml</code>中添添加：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-feature</span></span></span><br><span class="line"><span class="tag"> <span class="attr">android:name</span>=<span class="string">&quot;android.hardware.vr.headtracking&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">android:version</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">android:required</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>但是，因为<code>AndroidManifest.xml</code>是被生成出来的，我们直接修改文件也会被覆盖，所以应该添加到项目的设置中：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-project-setting-android-extra-permissions.webp"></p>
<p>看介绍，也可以编辑在<code>Build/Android/ManifestRequirementsOverride.txt</code>(若不存在，手动创建)，它会<strong>替换</strong>生成的<code>AndroidManifest.xml</code>中的<code>Requirements</code>部分，所以需要把已经生成的<code>AndroidManifest.xml</code>的<code>Requirements</code>部分加上强制启用<code>6DoF</code>的<code>user-feature</code>保存到<code>Build/Android/ManifestRequirementsOverride.txt</code>中：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Requirements --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-sdk</span> <span class="attr">android:minSdkVersion</span>=<span class="string">&quot;25&quot;</span> <span class="attr">android:targetSdkVersion</span>=<span class="string">&quot;25&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-feature</span> <span class="attr">android:name</span>=<span class="string">&quot;android.hardware.vr.headtracking&quot;</span> <span class="attr">android:version</span>=<span class="string">&quot;1&quot;</span> <span class="attr">android:required</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-feature</span> <span class="attr">android:glEsVersion</span>=<span class="string">&quot;0x00020000&quot;</span> <span class="attr">android:required</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WAKE_LOCK&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.android.vending.CHECK_LICENSE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_WIFI_STATE&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Supported texture compression formats (cooked) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">supports-gl-texture</span> <span class="attr">android:name</span>=<span class="string">&quot;GL_KHR_texture_compression_astc_ldr&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-feature</span> <span class="attr">android:name</span>=<span class="string">&quot;android.hardware.usb.host&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>重新运行或打包即可。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=SCl75YIUyAU">How to Fix Only One Controller Tracking on Oculus Quest (after the v7 update - using UE 4.22)</a></li>
</ul>
<h3 id="Package-and-Install"><a href="#Package-and-Install" class="headerlink" title="Package and Install"></a>Package and Install</h3><p>在UE中打包Android程序时有这个几个不同的可选Texture格式，目的是针对不同的硬件使用不同格式的压缩纹理：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/ue4-package-android-texture-format.webp"></p>
<blockquote>
<p>Not all Android devices are made the same. In particular, there are 4 different kinds of rendering hardware. They each support different formats of compressed textures.</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">Format</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>ETC1</strong></td>
<td>Supported by all Android based devices but cannot compress alpha textures (they are stored uncompressed). Recommend using an RGB and a separate alpha texture if need alpha to get better compression.</td>
</tr>
<tr>
<td align="center"><strong>ETC2</strong></td>
<td>Supported by all OpenGL 3.x class devices and supports alpha compression.</td>
</tr>
<tr>
<td align="center"><strong>ATC</strong></td>
<td>Supported by Qualcomm Adreno GPUs and supports alpha compression.</td>
</tr>
<tr>
<td align="center"><strong>DXT</strong></td>
<td>Supported by Nvidia Tegra GPUs and supports alpha compression.</td>
</tr>
<tr>
<td align="center"><strong>PVRTC</strong></td>
<td>supported by PowerVR GPUs and supports alpha compression.</td>
</tr>
<tr>
<td align="center"><strong>ASTC</strong></td>
<td>Latest Texture compression format allowing more quality control by specifying block size and supports alpha compression. Available on some devices at this point and will be required for Vulkan Level 1.</td>
</tr>
</tbody></table>
<p>UE文档的详细介绍：<a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-US/Platforms/Mobile/Android/Reference/index.html">Android Development Reference</a></p>
<p>因为Quest使用的是<strong>高通骁龙835</strong>，所以打包时选择<code>ATC</code>即可。</p>
<p>打包完成之后在<code>Binaries/Android</code>目录下会有如下文件：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+---Binaries</span><br><span class="line">|   \---Android</span><br><span class="line">|           Install_QuestTemp-armv7-es2.bat</span><br><span class="line">|           main.1.com.imzlp.QuestTemp.obb</span><br><span class="line">|           QuestTemp-armv7-es2.apk</span><br><span class="line">|           Uninstall_QuestTemp-armv7-es2.bat</span><br></pre></td></tr></table></figure>

<p>其中的<code>apk</code>与<code>obb</code>就是我们打包出来的游戏程序和数据包。<br>可以使用<code>adb</code>命令来安装apk和拷贝obb数据包。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb install QuestTemp-armv7-es2.apk</span><br><span class="line">20002 KB/s (47579881 bytes <span class="keyword">in</span> 2.322s)</span><br><span class="line">Success</span><br></pre></td></tr></table></figure>

<p>然后将数据包拷贝到<code>/sdcard/Android/obb/com.imzlp.QuestTemp/</code>目录下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb push main.1.com.imzlp.QuestTemp.obb /sdcard/Android/obb/com.imzlp.QuestTemp/main.1.com.imzlp.QuestTemp.obb</span><br></pre></td></tr></table></figure>

<blockquote>
<p>当然直接执行<code>Install_QuestTemp-armv7-es2.bat</code>也是可以的，它里面也是执行了这么几条指令。</p>
</blockquote>
<h3 id="VR-Template-Video"><a href="#VR-Template-Video" class="headerlink" title="VR Template Video"></a>VR Template Video</h3><p>我简单录了一个这个VR Template在Quest上运行的一个视频：<a target="_blank" rel="noopener" href="https://youtu.be/BbS-6PywD-g">Oculus Quest Template</a>，可以看到定位还是十分稳定的。</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/BbS-6PywD-g" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<h3 id="PC-View"><a href="#PC-View" class="headerlink" title="PC View"></a>PC View</h3><p>不同于PC VR在测试时可以直接把VR视角显示在PC显示器上，Quest的视角想要在PC上实时预览Quest的视角除了投屏之外可以使用<a target="_blank" rel="noopener" href="https://github.com/Genymobile/scrcpy">scrcpy</a>这个开源工具，它是专门用于显示和控制Android设备的，我经常用它来控制手机，需要使用数据线连接设备，使用adb连接。<a target="_blank" rel="noopener" href="https://github.com/Genymobile/scrcpy">scrcpy</a>在对Quest使用时显示的是双眼视角：<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/scrpcy-quest-view.webp"></p>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/30042/scrpcy-quest-view-2.webp"></p>
<h3 id="Debug-and-Performance"><a href="#Debug-and-Performance" class="headerlink" title="Debug and Performance"></a>Debug and Performance</h3><p>那么我们怎么查看在Quest运行的程序的参数呢，比如帧率、机器的负载情况。<br>可以使用Android的Debug工具<code>adb</code>与<code>logcat</code>命令来查看：<a target="_blank" rel="noopener" href="https://developer.oculus.com/documentation/mobilesdk/latest/concepts/book-anddebug/">Android Debugging</a>，以及<code>logcat</code>支持的参数：<a target="_blank" rel="noopener" href="https://developer.android.com/studio/command-line/logcat?hl=zh-cn">Logcat 命令行工具</a>。</p>
<p>首先，将Quest使用USB连接PC，启动游戏，然后在cmd的窗口中输入以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb logcat -s VrApi</span><br></pre></td></tr></table></figure>
<p>之后就会看到一堆的输出：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\visionsmile&gt;adb logcat -s VrApi</span><br><span class="line">--------- beginning of system</span><br><span class="line">--------- beginning of main</span><br><span class="line">09-28 23:00:12.250 18371 18386 D VrApi   : targetSDKVersion 25</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : DEVICE MODEL NUMBER = Quest</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : DEVICE HARDWARE = monterey</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : DEVICE BUILD NAME = user-358570.9320.0</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : DEVICE BUILD TYPE = user</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : DEVICE OS VERSION = 7.1.1</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : VRAPI VERSION = 1.1.25.0-171385671-171385671 Sep  7 2019 04:35:06 Development RELEASE</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : VRAPI LOADER VERSION = 1.1.16.0</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : VRDRIVER VERSION = 8.0.0.148.626</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : APP NAME = QuestTemp</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : APP VERSION = 1.0 versionCode 1 internalVersionName &lt;none&gt;</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : APP VR TYPE = vr_only</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : APP PACKAGE NAME = com.imzlp.QuestTemp</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : APP ACTIVITY CLASS = com.epicgames.ue4.GameActivity</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : ovrModeParms::VRAPI_MODE_FLAG_ALLOW_POWER_SAVE = 1</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : ovrModeParms::VRAPI_MODE_FLAG_RESET_WINDOW_FULLSCREEN = 1</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : ovrModeParms::VRAPI_MODE_FLAG_NATIVE_WINDOW = 1</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : ovrModeParms::VRAPI_MODE_FLAG_FRONT_BUFFER_PROTECTED = 0</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : ovrModeParms::VRAPI_MODE_FLAG_FRONT_BUFFER_565 = 0</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : ovrModeParms::VRAPI_MODE_FLAG_FRONT_BUFFER_SRGB = 0</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : ovrModeParms::VRAPI_MODE_FLAG_CREATE_CONTEXT_NO_ERROR = 0</span><br><span class="line">09-28 23:00:12.256 18371 18386 I VrApi   : HMD sensor attached.</span><br><span class="line">09-28 23:00:12.264 18371 18386 I VrApi   : Client side frame sync enabled</span><br><span class="line">09-28 23:00:12.276 18371 18386 I VrApi   : OVR::Stats thread started</span><br><span class="line">09-28 23:00:12.287 18371 18386 I VrApi   : System brightness = 255</span><br><span class="line">09-28 23:00:12.295 18371 18519 D VrApi   : targetSDKVersion 25</span><br><span class="line">09-28 23:00:12.300 18371 18386 I VrApi   : Set brightness to 255</span><br><span class="line">09-28 23:00:12.303 18371 18386 I VrApi   : Set DND mode to true</span><br><span class="line">09-28 23:00:12.329 18371 18386 I VrApi   : System DND mode = true</span><br><span class="line">09-28 23:00:12.329 18371 18386 I VrApi   : ---------- vrapi_EnterVrMode [end] ----------</span><br><span class="line">09-28 23:00:12.365 18371 18520 I VrApi   : ovr_HandleHmdEvents: HMT was mounted</span><br><span class="line">09-28 23:00:13.532 18371 18519 I VrApi   : FPS=23,Prd=47ms,Tear=0,Early=0,Stale=1,VSnc=1,Lat=1,Fov=0,CPU4/GPU=3/3,1958/515MHz,OC=FF,TA=0/E0/E0,SP=N/F/F,Mem=1804MHz,Free=1588MB,PSM=0,PLS=0,Temp=28.0C/0.0C,TW=3.40ms,App=10.26ms,GD=3.30ms,CPU&amp;GPU=9.47ms,LCnt=1,GPU%=0.62,CPU%=0.29(W0.33)</span><br><span class="line">09-28 23:00:14.341 18371 18519 I VrApi   : FPS=72,Prd=45ms,Tear=1,Early=62,Stale=10,VSnc=1,Lat=1,Fov=0,CPU4/GPU=3/3,1958/515MHz,OC=FF,TA=0/E0/E0,SP=N/F/F,Mem=1804MHz,Free=1592MB,PSM=0,PLS=0,Temp=28.0C/0.0C,TW=3.75ms,App=8.58ms,GD=0.00ms,CPU&amp;GPU=9.06ms,LCnt=1,GPU%=0.76,CPU%=0.27(W0.32)</span><br><span class="line">09-28 23:00:15.341 18371 18519 I VrApi   : FPS=72,Prd=45ms,Tear=0,Early=69,Stale=0,VSnc=1,Lat=1,Fov=0,CPU4/GPU=2/3,1651/515MHz,OC=FF,TA=0/E0/E0,SP=N/F/F,Mem=1804MHz,Free=1593MB,PSM=0,PLS=0,Temp=28.0C/0.0C,TW=2.96ms,App=9.17ms,GD=0.65ms,CPU&amp;GPU=9.24ms,LCnt=1,GPU%=0.77,CPU%=0.27(W0.33)</span><br></pre></td></tr></table></figure>
<p>可以看到<code>VrApi</code>输出的内容：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FPS=72,Prd=45ms,Tear=0,Early=69,Stale=0,VSnc=1,Lat=1,Fov=0,CPU4/GPU=2/3,1651/515MHz,OC=FF,TA=0/E0/E0,SP=N/F/F,Mem=1804MHz,Free=1593MB,PSM=0,PLS=0,Temp=28.0C/0.0C,TW=2.96ms,App=9.17ms,GD=0.65ms,CPU&amp;GPU=9.24ms,LCnt=1,GPU%=0.77,CPU%=0.27(W0.33)</span><br></pre></td></tr></table></figure>
<p>这是当前Quest中的跑游戏时设备的各种参数。<br>这些参数的含义可以从Oculus Quest的文档中查看：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.oculus.com/documentation/mobilesdk/latest/concepts/mobile-logcat-perf-stats/">Basic Performance Stats through Logcat</a></li>
</ul>
<h3 id="Capture-video-for-Quest"><a href="#Capture-video-for-Quest" class="headerlink" title="Capture video for Quest"></a>Capture video for Quest</h3><p>Oculus的CTO是游戏开发界的传奇人物——<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-hans/%E7%B4%84%E7%BF%B0%C2%B7%E5%8D%A1%E9%A6%AC%E5%85%8B">约翰·卡马克(john camark)</a>，他近期(2019.10.18)在twitter提到了在Go/Quest中满帧录屏的一个方法：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://twitter.com/ID_AA_Carmack/status/1184970761410351105">twitter link</a>：If you want to capture full 60/72 fps video on Go/Quest instead of half rate, you can ‘adb shell setprop debug.oculus.fullRateCapture 1’.</p>
</blockquote>
<p>即使用adb命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ adb shell setprop debug.oculus.fullRateCapture 1</span><br></pre></td></tr></table></figure>

<h3 id="Documents-and-Tutorial"><a href="#Documents-and-Tutorial" class="headerlink" title="Documents and Tutorial"></a>Documents and Tutorial</h3><p>Oculus Quest的开发文档：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.oculus.com/documentation/quest/latest/concepts/unreal-engine/">Oculus Quest - Unreal</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.oculus.com/documentation/mobilesdk/latest/concepts/book-perfanalysis/">Application Performance Analysis</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.oculus.com/distribute/latest/concepts/publish-quest-req/">Quest Virtual Reality Check (VRC) Guidelines</a></li>
</ul>
<p>UE的Android开发文档：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-US/Platforms/Mobile/Android/Reference/index.html">Android Development Reference</a></li>
</ul>
<p>视频教程：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=hEtu-ciPc7g">Using UE4 to Develop for Oculus Rift and Oculus Quest | Unreal Fest Europe 2019 | Unreal Engine</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=jlcj4HB9LX8">How to Build for Oculus Quest using Unreal Engine</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=SCl75YIUyAU">How to Fix Only One Controller Tracking on Oculus Quest (after the v7 update - using UE 4.22)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=N7UfYFq2Xq4">Oculus Quest Performance Profiling and Performance Optimization</a></li>
</ul>
<h3 id="Assets-Download"><a href="#Assets-Download" class="headerlink" title="Assets Download"></a>Assets Download</h3><p>本文内所有的资源：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://stusdnueducn-my.sharepoint.com/:f:/g/personal/2017020625_stu_sdnu_edu_cn/ErTM0Ov4H6FOoCoPKb1IaLoBevJ1J_M3vRqwEFNSUtTGZQ?e=If69z7">CodeWorks_1R7</a></li>
<li><a target="_blank" rel="noopener" href="https://stusdnueducn-my.sharepoint.com/:u:/g/personal/2017020625_stu_sdnu_edu_cn/EbE_rZl0OVpOrfyNOZ9DlGsBX0q-AcZHGvKhCz9JwBS5RA?e=pTGgQf">NVPACK_1R7u1_20190923</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/the-expanse/SideQuest/releases">SideQuest</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Genymobile/scrcpy">scrcpy</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/hxhb/oculus-quest-template">Oculus Quest VR Template Project：QuestTemp</a></li>
<li>打包出来的QuestTemp：<a target="_blank" rel="noopener" href="https://stusdnueducn-my.sharepoint.com/:u:/g/personal/2017020625_stu_sdnu_edu_cn/ERiJmF8KLLBJuKQ8yLKswUgBk2_oChRqC_nEvH-A31_Xug?e=J6fdGx">QuestTemp-armv7-es2.7z</a></li>
</ul>
<h3 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h3><p><strong>Not-PC based VR</strong>:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developers.google.com/vr">Google VR</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.oculus.com/quest/">Oculus Quest</a></li>
</ul>

    </div>

    
    
        
        
          
            <blockquote class="blockquote-center">
              
                全文完，若有不足之处请评论指正。
              
            <br/>
            
                <div class="qr-code" onclick="return false">
                    <script src="/js/qrcode.min.js"></script>
                    <div id="qrcode">
                      
                        <img src="https://imzlp.com/images/wechat-qrcode.webp">
                      
                    <p>微信扫描二维码，关注我的公众号。</p>
                    </div>
                </div>
            
            </blockquote>
          
        

        
          <div class="postCopyright" style="clear:both;">
             <span>本文标题:</span><a href="/posts/30042/" target="_blank">Oculus Quest Development with UE4</a><br/>
             <span>文章作者:</span><a href="/about" target="_blank" title="查看 查利鹏 的资料">查利鹏</a><br/>
             <span>发布时间:</span>2019年09月24日 10时41分<br/>
             
              <span>更新时间:</span>2020年09月17日 21时31分<br/>
             
             <span>本文字数:</span><span class="page-count">本文一共有6.7k字</span><br/>
             
             <span>原始链接:</span><a href="/posts/30042/" target="_blank" title="Oculus Quest Development with UE4">https://imzlp.com/posts/30042/</a>
             <span class="copy-path" data-clipboard-text="原文链接: https://imzlp.com/posts/30042/ 作者: 查利鹏" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
             <script src="/js/jquery.min.js"></script>
             <script src="/js/clipboard.min.js"></script>
             <script> var clipboard = new Clipboard('.copy-path'); </script>
             <br/>
             
             <span>许可协议:</span><i class="fab fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="Attribution-NonCommercial-ShareAlike 4.0 International">CC BY-NC-SA 4.0</a><br/>
             
             <span>文章禁止全文转载，摘要转发请保留原文链接及作者信息，谢谢！</span>
          </div>
        
    
        
  <div class="reward-container">
    <div>您的捐赠将鼓励我继续创作！</div>
    <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
      打赏
    </button>
    <div id="qr" style="display: none;">
        
        <div style="display: inline-block;">
          <img src="/images/reward/wechatpay.webp" alt="查利鹏 微信支付">
          <p>微信支付</p>
        </div>

    </div>
  </div>



      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/UnrealEngine/" rel="tag"># UnrealEngine</a>
              <a href="/tags/VR/" rel="tag"># VR</a>
              <a href="/tags/OculusQuest/" rel="tag"># OculusQuest</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/20203/" rel="prev" title="Export Recast Navigation Data from UE4">
      <i class="fa fa-chevron-left"></i> Export Recast Navigation Data from UE4
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/16643/" rel="next" title="UE Build System：Target and Module">
      UE Build System：Target and Module <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-utteranc">utteranc</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane utteranc" id="comment-utteranc">
              
  
  <div class="comments">
  <script src="https://utteranc.es/client.js" repo="hxhb/blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script>
  </div>
  
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Oculus-Developer-Mode"><span class="nav-number">1.</span> <span class="nav-text">Oculus Developer Mode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NVIDIA-CodeWorks-for-Android"><span class="nav-number">2.</span> <span class="nav-text">NVIDIA CodeWorks for Android</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-Quest-Project-with-UE4"><span class="nav-number">3.</span> <span class="nav-text">Create Quest Project with UE4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3Quest%E5%8F%AA%E8%BF%BD%E8%B8%AA%E4%B8%80%E5%8F%AA%E6%89%8B%E6%9F%84"><span class="nav-number">4.</span> <span class="nav-text">解决Quest只追踪一只手柄</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Package-and-Install"><span class="nav-number">5.</span> <span class="nav-text">Package and Install</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VR-Template-Video"><span class="nav-number">6.</span> <span class="nav-text">VR Template Video</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PC-View"><span class="nav-number">7.</span> <span class="nav-text">PC View</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Debug-and-Performance"><span class="nav-number">8.</span> <span class="nav-text">Debug and Performance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Capture-video-for-Quest"><span class="nav-number">9.</span> <span class="nav-text">Capture video for Quest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Documents-and-Tutorial"><span class="nav-number">10.</span> <span class="nav-text">Documents and Tutorial</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Assets-Download"><span class="nav-number">11.</span> <span class="nav-text">Assets Download</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Other"><span class="nav-number">12.</span> <span class="nav-text">Other</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person" oncontextmenu="return false" οndragstart="return false">
    <img class="site-author-image" itemprop="image" alt="查利鹏"
      src="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
  <p class="site-author-name" itemprop="name">查利鹏</p>
  <div class="site-description" itemprop="description">唯有热爱可抵岁月漫长。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
             
          <span class="site-state-item-count">189</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">94</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">188</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hxhb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hxhb" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://linkedin.com/in/lipengzha" title="Linkedin → https:&#x2F;&#x2F;linkedin.com&#x2F;in&#x2F;lipengzha" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/imzlp" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;imzlp" rel="noopener" target="_blank"><i class="fa fa-custom zhihu fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/wechat-qrcode-offical.webp" title="微信公众号 → &#x2F;images&#x2F;wechat-qrcode-offical.webp"><i class="fab fa-weixin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:imzlp@foxmail.com" title="E-Mail → mailto:imzlp@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://consolehelp.imzlp.com/" title="https:&#x2F;&#x2F;consolehelp.imzlp.com&#x2F;" rel="noopener" target="_blank">UE Console Help</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/opensource/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;opensource&#x2F;">Open Source Projects</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/posts/11515/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;posts&#x2F;11515&#x2F;">UE C++ API Dash Documents</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ue5wiki.com/" title="https:&#x2F;&#x2F;ue5wiki.com&#x2F;" rel="noopener" target="_blank">Unreal Engine Wiki</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">粤ICP备2021027036号 </a>
      <img src="/images/beian_logo.webp" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030502007298" rel="noopener" target="_blank">粤公网安备44030502007298号 </a>
  </div>

<div class="copyright">
  
  &copy; 2014 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">查利鹏</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">747k</span>
</div>
  <div class="powered-by-other">
    
	    <center>Github Pages | Actions | NeXT | Cloudflare | Hexo Deploy</center>
      
  </div>

<script>
function checkWebp(callback) {
    var img = new Image();
    img.onload = function () { callback((img.width > 0) && (img.height > 0)); };
    img.onerror = function () { callback(false); };
    img.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';
}
function showImage(useWebp) {
    var imgs = [].slice.call(document.querySelectorAll('img'));
    imgs.forEach(function (e) {
        if (!useWebp) {
            var src = e.getAttribute('data-src')
            src = src.replace(/\.webp$/, '.png');
            e.setAttribute('data-src', src);
        }
    });
}
checkWebp(showImage);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/animejs/3.2.1/anime.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.5.1/jquery.min.js"></script>
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/lozad.js/1.16.0/lozad.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/pangu/4.0.7/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>



<script src="/js/code-unfold.js"></script>

  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

  
  <script src="//img.imzlp.com/imgs/zlp/picgo/2021/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://imzlp.com/posts/30042/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/valine/1.4.14/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    var requiredFields = 'nick';
    requiredFields = requiredFields.split(',');
    
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'oCE6RMVkVoi5MgUhvFsn1EvV-gzGzoHsz',
      appKey     : 'K9SOaNYJ8PV6xaoFggWG5xvv',
      placeholder: "留下点什么吧~",
      avatar     : 'robohash',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : '',
      requiredFields: requiredFields
    });
  }, window.Valine);
});
</script>

</body>
</html>
